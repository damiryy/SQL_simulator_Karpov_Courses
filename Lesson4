Задача 1
Напишите SQL-запрос к таблице products и выведите всю информацию о товарах, цена которых не превышает 100 рублей. Результат отсортируйте по возрастанию id товара.

Поля в результирующей таблице: product_id, name, price
Решение: 
SELECT product_id,
       name,
       price
FROM   products
WHERE  price <= 100
ORDER BY product_id
--------------------------------------------------
Задача 2
Отберите пользователей женского пола из таблицы users. Выведите только id этих пользователей. Результат отсортируйте по возрастанию id.

Добавьте в запрос оператор LIMIT и выведите только 1000 первых id из отсортированного списка.

Поле в результирующей таблице: user_id
Решение
SELECT user_id
FROM   users
WHERE  sex = 'female'
ORDER BY user_id limit 1000
-----------------------------------------------------
Задача 3.
Отберите из таблицы user_actions все действия пользователей по созданию заказов, которые были совершены ими после полуночи 6 сентября 2022 года. Выведите колонки с id пользователей, id созданных заказов и временем их создания.
Результат должен быть отсортирован по возрастанию id заказа.
Поля в результирующей таблице: user_id, order_id, time
Обратите внимание, что в таблице user_actions у каждого пользователя могут быть записи не только со временем создания заказа, но и временем его отмены. Нам необходимо получить только записи с созданием заказов.
Решение
SELECT user_id,
       order_id,
       time
FROM   user_actions
WHERE  action = 'create_order'
   and time > '2022-09-06'
ORDER BY order_id
-----------------------------------------------------------------
Задача 4.
Назначьте скидку 20% на все товары из таблицы products и отберите те, цена на которые с учётом скидки превышает 100 рублей. Выведите id товаров, их наименования, прежнюю цену и новую цену с учётом скидки. Колонку со старой ценой назовите old_price, с новой — new_price.
Результат должен быть отсортирован по возрастанию id товара.
Поля в результирующей таблице: product_id, name, old_price, new_price
Пояснение:
Будьте внимательны, когда будете указывать фильтр после оператора WHERE.
Решение:
SELECT product_id,
       name,
       price as old_price,
       price * 0.8 as new_price
FROM   products
WHERE  price * 0.8 > 100
ORDER BY product_id asc;
-----------------------------------------------------------------------
Задача 5.
Отберите из таблицы products все товары, названия которых либо начинаются со слова «чай», либо состоят из пяти символов. Выведите две колонки: id товаров и их наименования.
Результат должен быть отсортирован по возрастанию id товара.
Поля в результирующей таблице: product_id, name
Пояснение:
Для решения задачи вам пригодятся функции SPLIT_PART и LENGTH, которые мы рассматривали на прошлом уроке
Решение:
SELECT product_id,
       name
FROM   products
WHERE  split_part(name, ' ', 1) = 'чай'
    or length(name) = 5
ORDER BY product_id;
--------------------------------------
